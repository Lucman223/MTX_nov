<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pr√©sentation Technique MotoTX</title>
    <!-- PrismJS for Syntax Highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1a1a1a;
            color: #fff;
            overflow: hidden;
            height: 100vh;
            display: flex;
        }

        /* Layout: Split Screen */
        .main-container {
            display: flex;
            width: 100%;
            height: 100%;
        }

        .slide-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            background-color: #2d2d2d;
            position: relative;
            overflow-y: auto;
            transition: width 0.3s ease;
        }

        .code-panel {
            flex: 1;
            background-color: #1e1e1e;
            border-left: 2px solid #444;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            width: 0;
            /* Default hidden if no code */
            transition: width 0.3s ease;
        }

        .code-panel.active {
            width: 50%;
            /* Show half screen when active */
        }

        /* When code is active, slide panel takes other half */
        .code-panel.active~.slide-panel,
        .main-container.has-code .slide-panel {
            flex: 1;
        }

        .code-header {
            padding: 10px 20px;
            background-color: #252526;
            border-bottom: 1px solid #333;
            font-family: monospace;
            font-size: 0.9em;
            color: #9cdcfe;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .code-content {
            flex: 1;
            overflow: auto;
            padding: 0;
            margin: 0;
            font-size: 13px;
        }

        /* Slide Content Styles */
        .slide-block {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            width: 100%;
            height: 100%;
            animation: fadeIn 0.5s ease-in-out;
        }

        .slide-block.active {
            display: flex;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            color: #4CAF50;
            margin-bottom: 20px;
            font-size: 2.5em;
        }

        h2 {
            color: #81C784;
            margin-bottom: 15px;
            font-size: 2em;
        }

        h3 {
            color: #A5D6A7;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        p,
        ul {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 20px;
            max-width: 800px;
            color: #ddd;
        }

        ul {
            text-align: left;
        }

        img {
            max-width: 100%;
            max-height: 50vh;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            margin-top: 20px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        img:hover {
            transform: scale(1.02);
        }

        /* Controls */
        .controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            justify-content: center;
            gap: 20px;
            align-items: center;
            width: 80%;
            z-index: 10;
            padding: 10px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 30px;
        }

        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #45a049;
        }

        button:disabled {
            background-color: #555;
            cursor: not-allowed;
        }

        .slide-number {
            font-size: 0.9em;
            color: #bbb;
        }

        /* Syntax Highlighter Overrides */
        pre[class*="language-"] {
            margin: 0 !important;
            height: 100%;
            border-radius: 0 !important;
        }

        /* Modal for full screen image */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            padding-top: 50px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.9);
        }

        .modal-content {
            margin: auto;
            display: block;
            max-width: 90%;
            max-height: 90%;
        }

        .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
        }
    </style>
</head>

<body>

    <div class="main-container" id="mainContainer">

        <!-- Left Panel: Content -->
        <div class="slide-panel">

            <!-- Slide 1 -->
            <div class="slide-block active" data-code="">
                <h1>Pr√©sentation de la Plateforme MotoTX</h1>
                <p>Bienvenue dans la documentation visuelle et <strong>TECHNIQUE</strong> de <strong>MotoTX</strong>.
                </p>
                <p>Cette pr√©sentation inclut le code source r√©el qui propulse chaque vue.</p>
            </div>

            <!-- Slide: Architecture Section -->
            <div class="slide-block">
                <h2>Architecture Technique</h2>
                <p>Vue d'ensemble de la structure du projet (Monolithe).</p>
            </div>

            <!-- Slide: Global Structure -->
            <div class="slide-block" data-code="code-arch-global">
                <h3>Architecture Globale</h3>
                <p>Le projet suit une approche <strong>Monolithique</strong> :</p>
                <ul>
                    <li><strong>Backend :</strong> Laravel (PHP) - API & Base de donn√©es.</li>
                    <li><strong>Frontend :</strong> React (JS) - Interface Utilisateur.</li>
                    <li><strong>Int√©gration :</strong> Les deux r√©sident dans le m√™me d√©p√¥t. Laravel sert l'application
                        React via Vite.</li>
                </ul>
            </div>

            <!-- Slide: Backend Structure -->
            <div class="slide-block" data-code="code-arch-backend">
                <h3>Structure Backend (Laravel)</h3>
                <p>Organisation modulaire standard de Laravel :</p>
                <ul>
                    <li><strong>Controllers :</strong> Point d'entr√©e des requ√™tes API.</li>
                    <li><strong>Services :</strong> Logique m√©tier complexe.</li>
                    <li><strong>Models :</strong> Repr√©sentation des donn√©es (DB).</li>
                    <li><strong>Routes :</strong> D√©finition des endpoints API.</li>
                </ul>
            </div>

            <!-- Slide: Frontend Structure -->
            <div class="slide-block" data-code="code-arch-frontend">
                <h3>Structure Frontend (React)</h3>
                <p>Le code React se trouve dans <code>backend/resources/js</code>.</p>
                <ul>
                    <li><strong>Pages :</strong> Vues principales (Login, Dashboard).</li>
                    <li><strong>Components :</strong> √âl√©ments r√©utilisables.</li>
                    <li><strong>Context :</strong> Gestion d'√©tat global (Auth).</li>
                </ul>
            </div>

            <!-- Slide 2 -->
            <div class="slide-block">
                <h2>1. Vues G√©n√©rales</h2>
            </div>

            <!-- Slide 3: Landing -->
            <div class="slide-block" data-code="code-landing">
                <h3>Page d'Accueil (Landing Page)</h3>
                <p>La porte d'entr√©e de la plateforme. Elle pr√©sente la proposition de valeur, permet un acc√®s rapide √†
                    l'inscription et √† la connexion, et fournit des informations g√©n√©rales sur le service.</p>
                <img src="general_home.png" alt="Home Page" onclick="openModal(this)">
            </div>

            <!-- Slide 4: Registro -->
            <div class="slide-block" data-code="code-register">
                <h3>Inscription des Utilisateurs</h3>
                <p>Un formulaire unifi√© permettant aux nouveaux utilisateurs de s'inscrire en s√©lectionnant leur r√¥le
                    (Client ou Conducteur). Design √©pur√© et validation en temps r√©el.</p>
                <img src="general_registro.png" alt="Registre" onclick="openModal(this)">
            </div>

            <!-- Slide 5 -->
            <div class="slide-block">
                <h2>2. R√¥le : Client</h2>
                <p>Logique m√©tier c√¥t√© client.</p>
            </div>

            <!-- Slide 6: Dashboard Cliente -->
            <div class="slide-block" data-code="code-client-dash">
                <h3>Tableau de Bord Client</h3>
                <p>Le panneau principal o√π le client peut :</p>
                <ul>
                    <li>Voir son solde de trajets disponibles (Forfaits).</li>
                    <li>Demander un nouveau trajet en s√©lectionnant l'origine et la destination sur la carte
                        interactive.</li>
                    <li>Voir l'√©tat de sa demande actuelle.</li>
                </ul>
                <img src="cliente_dashboard.png" alt="Dashboard Client" onclick="openModal(this)">
            </div>

            <!-- Slide 7: Forfaits -->
            <div class="slide-block" data-code="code-client-forfaits">
                <h3>Achat de Forfaits</h3>
                <p>Section d√©di√©e au rechargement de trajets. Les clients peuvent acheter des packs de trajets
                    (forfaits) en utilisant des passerelles de paiement int√©gr√©es (Simulation Orange Money).</p>
                <img src="cliente_forfaits.png" alt="Achat Forfaits" onclick="openModal(this)">
            </div>

            <!-- Slide 8: Historial -->
            <div class="slide-block" data-code="code-client-hist">
                <h3>Historique des Trajets</h3>
                <p>Registre complet des trajets effectu√©s, avec des d√©tails tels que la date, le conducteur assign√© et
                    l'√©tat du trajet.</p>
                <img src="cliente_historial.png" alt="Historique" onclick="openModal(this)">
            </div>

            <!-- Slide 9: Perfil -->
            <div class="slide-block" data-code="code-client-prof">
                <h3>Profil Client</h3>
                <p>Gestion des donn√©es personnelles, du mot de passe et des pr√©f√©rences du compte.</p>
                <img src="cliente_perfil.png" alt="Profil" onclick="openModal(this)">
            </div>

            <!-- Slide 10 -->
            <div class="slide-block">
                <h2>3. R√¥le : Motard</h2>
                <p>Interface de travail en temps r√©el.</p>
            </div>

            <!-- Slide 11: Dashboard Motorista -->
            <div class="slide-block" data-code="code-moto-dash">
                <h3>Tableau de Bord Motard</h3>
                <p>Outil de travail quotidien. Il permet de :</p>
                <ul>
                    <li>Se mettre "En Ligne" ou "Hors Ligne" pour recevoir des demandes.</li>
                    <li>Voir et accepter de nouvelles demandes de trajet en temps r√©el.</li>
                    <li>G√©rer l'√©tat du trajet actuel (Accepter -> En Cours -> Terminer).</li>
                </ul>
                <img src="motorista_dashboard.png" alt="Dashboard Moto" onclick="openModal(this)">
            </div>

            <!-- Slide 12: Historial Motorista -->
            <div class="slide-block" data-code="code-moto-hist">
                <h3>Historique des Services</h3>
                <p>Journal de tous les trajets effectu√©s par le conducteur, utile pour suivre son activit√©.</p>
                <img src="motorista_historial.png" alt="Historique Moto" onclick="openModal(this)">
            </div>

            <!-- Slide 13: Perfil Motorista -->
            <div class="slide-block" data-code="code-moto-prof">
                <h3>Profil Motard</h3>
                <p>Informations personnelles du conducteur.</p>
                <img src="motorista_perfil.png" alt="Profil Moto" onclick="openModal(this)">
            </div>

            <!-- Slide 14 -->
            <div class="slide-block">
                <h2>4. R√¥le : Administrateur</h2>
                <p>Gestion et supervision globale.</p>
            </div>

            <!-- Slide 15: Admin Dash -->
            <div class="slide-block" data-code="code-admin-dash">
                <h3>Tableau de Bord Admin</h3>
                <p>Vue globale de l'√©tat du syst√®me. Affiche des KPI importants tels que :</p>
                <ul>
                    <li>Total des conducteurs et des clients.</li>
                    <li>Revenus du mois.</li>
                    <li>Graphiques d'activit√© et de performance.</li>
                </ul>
                <img src="admin_dashboard.png" alt="Admin Dash" onclick="openModal(this)">
            </div>

            <!-- Slide 16: Admin Clientes -->
            <div class="slide-block" data-code="code-admin-clients">
                <h3>Gestion des Clients</h3>
                <p>Tableau complet de tous les clients inscrits, permettant de voir les d√©tails et de g√©rer les comptes.
                </p>
                <img src="admin_clientes.png" alt="Admin Clients" onclick="openModal(this)">
            </div>

            <!-- CONTROLS -->
            <div class="controls">
                <button id="prevBtn" onclick="plusSlides(-1)">‚ùÆ</button>
                <span class="slide-number">1 / 20</span>
                <button id="nextBtn" onclick="plusSlides(1)">‚ùØ</button>
                <button onclick="toggleCode()" id="codeToggleBtn" style="background:#2196F3; font-size:0.9em">üëÅÔ∏è
                    Code</button>
            </div>

        </div>

        <!-- Right Panel: Code -->
        <div class="code-panel" id="codePanel">
            <div class="code-header">
                <span id="fileName">Source.jsx</span>
            </div>
            <div class="code-content">
                <pre><code id="codeBlock" class="language-jsx">// Le code appara√Ætra ici...</code></pre>
            </div>
        </div>

    </div>

    <!-- The Modal -->
    <div id="myModal" class="modal">
        <span class="close" onclick="closeModal()">&times;</span>
        <img class="modal-content" id="img01">
    </div>

    <!-- Hidden Data Stores for Code -->
    <script type="text/plain" id="code-arch-global">
// üìÇ STRUCTURE DU PROJET

/backend (Racine du Projet)
‚îú‚îÄ‚îÄ /app                # Code Backend (PHP)
‚îú‚îÄ‚îÄ /routes             # Routes API
‚îú‚îÄ‚îÄ /resources
‚îÇ   ‚îú‚îÄ‚îÄ /views          # Vues Blade (entry point)
‚îÇ   ‚îî‚îÄ‚îÄ /js             # ‚öõÔ∏è CODE FRONTEND (React)
‚îú‚îÄ‚îÄ /public             # Assets publics
‚îú‚îÄ‚îÄ .env                # Configuration
‚îî‚îÄ‚îÄ package.json        # D√©pendances JS
    </script>

    <script type="text/plain" id="code-arch-backend">
// üîß STRUCTURE BACKEND (Laravel)

/app
‚îú‚îÄ‚îÄ /Http/Controllers   # üéÆ Contr√¥leurs
‚îÇ   ‚îú‚îÄ‚îÄ AuthController.php
‚îÇ   ‚îú‚îÄ‚îÄ ViajeController.php
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ /Models             # üì¶ Mod√®les (DB)
‚îÇ   ‚îú‚îÄ‚îÄ User.php
‚îÇ   ‚îú‚îÄ‚îÄ Viaje.php
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ /Services           # üß† Logique M√©tier
‚îÇ   ‚îî‚îÄ‚îÄ MotoristaService.php
‚îî‚îÄ‚îÄ ...

/routes
‚îî‚îÄ‚îÄ api.php             # üõ£Ô∏è Routes API
    </script>

    <script type="text/plain" id="code-arch-frontend">
// üé® STRUCTURE FRONTEND (React)
// Chemin: backend/resources/js

/resources/js
‚îú‚îÄ‚îÄ /pages              # üìÑ √âcrans
‚îÇ   ‚îú‚îÄ‚îÄ /Public (Login, Landing)
‚îÇ   ‚îú‚îÄ‚îÄ /Cliente (Dashboard...)
‚îÇ   ‚îî‚îÄ‚îÄ /Motorista (Dashboard...)
‚îú‚îÄ‚îÄ /components         # üß© Composants R√©utilisables
‚îÇ   ‚îú‚îÄ‚îÄ Navbar.jsx
‚îÇ   ‚îú‚îÄ‚îÄ Map.jsx
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ /context            # üåê √âtat Global
‚îÇ   ‚îî‚îÄ‚îÄ AuthContext.jsx
‚îî‚îÄ‚îÄ app_entry.jsx       # üö™ Point d'Entr√©e
    </script>
    <script type="text/plain" id="code-landing">
import React from 'react';
import { useNavigate } from 'react-router-dom';

const LandingPage = () => {
    // Hook de navigation React Router pour rediriger sans recharger la page
    const navigate = useNavigate();
    
    // Objet de configuration pour les cartes "Caract√©ristiques"
    // Utiliser un tableau d'objets permet de rendre des listes dynamiques avec .map()
    // facilitant la maintenance et l'√©volutivit√© du contenu.
    const features = [
        { icon: 'üöÄ', title: 'Rapide', desc: 'En quelques minutes...' },
        { icon: 'üí∞', title: '√âconomique', desc: 'Prix justes...' }
    ];

    // Rendu du composant visuel (JSX)
    return (
        <div className="landing-container">
            {/* Header : Barre de navigation sup√©rieure */}
            <header>
                {/* Titre principal de l'application */}
                <h1>MotoTX</h1>
                {/* Bouton d'acc√®s : Navigue vers la route prot√©g√©e /login */}
                <button onClick={() => navigate('/login')}>Login</button>
            </header>
            
            {/* Hero Section : Zone mise en avant pour capter l'attention de l'utilisateur */}
            <section className="hero">
                <h2>Votre transport √† Bamako</h2>
                {/* CTA (Call to Action) principal : D√©marre le flux d'inscription */}
                <button onClick={() => navigate('/register')}>Commencer</button>
            </section>

            {/* Grille de Features : Affiche les avantages comp√©titifs */}
            <section className="features">
                {/* Nous it√©rons sur le tableau 'features' pour g√©n√©rer les √©l√©ments du DOM */}
                {features.map((f, i) => (
                    // La prop 'key' est essentielle pour l'algorithme de r√©conciliation de React
                    <div key={i} className="feature-card">
                        <span>{f.icon}</span>
                        <h3>{f.title}</h3>
                    </div>
                ))}
            </section>
        </div>
    );
};
// Exportation par d√©faut pour permettre le Code Splitting et le Lazy Loading
export default LandingPage;
    </script>

    <script type="text/plain" id="code-register">
import React, { useState } from 'react';
import { useNavigate } from 'react-router-dom';

function RegisterPage() {
    // Hook useState : Contr√¥le l'√©tat local du 'r√¥le' s√©lectionn√©.
    // Initialis√© √† 'client' par d√©faut. D√©termine la logique m√©tier √† appliquer.
    const [rol, setRol] = useState('cliente');
    
    // Hook useState : Objet unique pour g√©rer plusieurs champs du formulaire.
    // √âvite d'avoir plusieurs variables d'√©tat s√©par√©es.
    const [formData, setFormData] = useState({
        name: '', email: '', password: ''
    });

    // Fonction asynchrone pour g√©rer l'envoi du formulaire au Backend
    const handleSubmit = async (e) => {
        // Emp√™che le rechargement automatique de la page par d√©faut en HTML
        e.preventDefault();
        try {
            // Requ√™te HTTP POST utilisant Axios vers l'API RESTful de Laravel
            // Utilisation du Spread Operator (...) pour combiner les donn√©es du form + le r√¥le s√©lectionn√©
            await axios.post('/api/register', { ...formData, rol });
            
            // Si la promesse est r√©solue avec succ√®s (HTTP 200/201),
            // nous redirigeons l'utilisateur vers son tableau de bord priv√©
            navigate('/dashboard');
        } catch (error) {
            // Gestion basique des erreurs (en prod nous utiliserions un Toast ou une Alerte)
            console.error("Erreur d'inscription", error);
        }
    };

    return (
        <form onSubmit={handleSubmit}>
            {/* Feedback visuel dynamique selon le r√¥le actuel */}
            <h2>Inscription {rol}</h2>
            
            {/* Toggle Switch personnalis√© pour la s√©lection des r√¥les */}
            <div className="role-selector">
                {/* Au clic, nous mettons √† jour l'√©tat 'rol' √† 'client' */}
                <button onClick={() => setRol('cliente')}>Client</button>
                {/* Au clic, nous mettons √† jour l'√©tat 'rol' √† 'motorista' (Motard) */}
                <button onClick={() => setRol('motorista')}>Motard</button>
            </div>

            {/* Champ Contr√¥l√© (Controlled Input) */}
            <input type="text" placeholder="Nom" 
                // Mise √† jour immuable de l'objet d'√©tat 'formData'
                onChange={e => setFormData({...formData, name: e.target.value})} />
            
            <button type="submit">Cr√©er le Compte</button>
        </form>
    );
}
export default RegisterPage;
    </script>

    <script type="text/plain" id="code-client-dash">
const ClienteDashboard = () => {
    // √âtat Local : Stocke les informations du trajet actuel en cours (si existant)
    const [activeTrip, setActiveTrip] = useState(null);
    // √âtats pour les coordonn√©es s√©lectionn√©es sur la carte
    const [origen, setOrigen] = useState(null);
    const [destino, setDestino] = useState(null);

    // useEffect avec [] de d√©pendances : S'ex√©cute uniquement au montage du composant
    // Impl√©mente un mod√®le de "Long Polling" simplifi√©
    useEffect(() => {
        // Intervalle qui s'ex√©cute toutes les 5000ms (5 secondes)
        const interval = setInterval(async () => {
            // Requ√™te GET pour v√©rifier l'√©tat actuel de l'utilisateur
            // Cela permet de mettre √† jour l'UI si le conducteur accepte le trajet en temps r√©el
            const res = await axios.get('/api/viajes/actual');
            setActiveTrip(res.data);
        }, 5000);
        
        // Cleanup Function : Nettoie le timer lorsque le composant est d√©mont√©
        // √âvite les fuites de m√©moire et les appels fant√¥mes
        return () => clearInterval(interval);
    }, []);

    // Gestionnaire de l'√©v√©nement de demande de trajet
    const handleSolicitarWrapper = async () => {
        // Validation pr√©coce : Ne pas permettre l'envoi s'il manque des points
        if(!origen || !destino) return; 
        
        // Requ√™te POST pour cr√©er une nouvelle entr√©e dans la table 'trips'
        await axios.post('/api/viajes/solicitar', {
            origen, destino // Payload avec les coordonn√©es
        });
        // L'UI se mettra √† jour automatiquement lors du prochain cycle de l'intervalle
    };

    return (
        <div className="dashboard">
            {/* Sidebar : Panneau de contr√¥le lat√©ral */}
            <div className="sidebar">
                {/* Composant de Pr√©sentation : Affiche l'√©tat (En attente, En cours, etc.) */}
                <StatusCard trip={activeTrip} />
                <button onClick={handleSolicitarWrapper}>
                    Commander un Trajet
                </button>
            </div>
            
            {/* Conteneur de la Carte (Wrapper Leaflet/Google Maps) */}
            <div className="map-container">
                {/* Nous passons les setters comme props pour remonter l'√©tat depuis la carte */}
                <MapSelection 
                    setOrigen={setOrigen} 
                    setDestino={setDestino} 
                />
            </div>
        </div>
    );
};
    </script>

    <script type="text/plain" id="code-client-forfaits">
const ClienteForfaits = () => {
    // √âtat pour stocker la liste des produits (paquets de trajets)
    const [forfaits, setForfaits] = useState([]);
    
    // Chargement des donn√©es √† l'initialisation du composant
    useEffect(() => {
        // Appel √† l'API publique pour obtenir le catalogue des prix
        axios.get('/api/forfaits/disponibles')
             .then(res => setForfaits(res.data)); // Sauvegarder la r√©ponse dans l'√©tat
    }, []);

    // Logique pour initier le flux de paiement mobile
    const handleBuy = async (forfaitId) => {
        // 1. Nous initions la transaction dans notre backend pour obtenir un OrderID
        // Cela contacte l'API d'Orange Money / prestataire de paiement
        const res = await axios.post('/api/pay/init', { forfaitId });
        
        // 2. Si la passerelle r√©pond 'pending', nous devons attendre la confirmation
        if(res.data.status === 'pending') {
            // Nous initions le sondage de l'√©tat de cette transaction sp√©cifique
            pollPaymentStatus(res.data.orderId);
        }
    };

    return (
        <div className="grid-forfaits">
            {/* Rendu dynamique de la liste des produits */}
            {forfaits.map(f => (
                // Carte interactive qui initie l'achat au clic
                <Card key={f.id} onClick={() => handleBuy(f.id)}>
                    <h3>{f.nombre}</h3>
                    <p>{f.precio} CFA</p> {/* Prix format√© */}
                    <span>{f.viajes} Trajets</span> {/* Cr√©dits offerts */}
                </Card>
            ))}
        </div>
    );
};
    </script>

    <script type="text/plain" id="code-client-hist">
const ClienteHistory = () => {
    // Stocke l'historique complet des trajets de l'utilisateur
    const [viajes, setViajes] = useState([]);

    // Fonction ex√©cut√©e lorsque l'utilisateur envoie une notation (1-5 √©toiles)
    const rateTrip = async (id, score) => {
        // Nous envoyons la note au point de terminaison sp√©cifique de ce trajet
        await axios.post(`/api/viajes/${id}/rate`, { score });
        // Nous rechargeons la liste pour montrer la nouvelle note et retirer le bouton
        refreshList(); 
    };

    return (
        <div className="list-container">
            {/* Nous it√©rons sur le tableau des trajets historiques */}
            {viajes.map(v => (
                <div className="trip-item">
                    {/* D√©tails de base du trajet */}
                    <span>{v.fecha}</span>
                    <span>Motard : {v.motorista.name}</span>
                    <div className="status">{v.estado}</div> {/* ex: 'completed' */}
                    
                    {/* Rendu Conditionnel : */}
                    {/* Nous affichons le bouton seulement si 'v.rating' est null/undefined */}
                    {!v.rating && (
                        <button onClick={() => openModal(v.id)}>
                            Noter
                        </button>
                    )}
                </div>
            ))}
        </div>
    );
};
    </script>

    <script type="text/plain" id="code-client-prof">
const ClienteProfile = () => {
    // Destructuring du Contexte Global AuthContext
    // 'user' contient l'objet utilisateur connect√© avec toutes ses propri√©t√©s
    const { user } = useAuth();
    
    // √âtat local pour afficher le solde (pourrait √™tre obtenu de user.wallet)
    const [balance, setBalance] = useState(0);

    return (
        <div className="profile">
            {/* Carte d'Informations Personnelles : Lecture seule */}
            <div className="info-card">
                <img src={user.avatar} /> {/* Image de profil */}
                <h2>{user.name}</h2>
                <p>{user.email}</p>
            </div>

            {/* Carte de M√©triques / Actions Importantes */}
            <div className="stats-card">
                <h3>Mes Trajets Restants</h3>
                <div className="big-number">{balance}</div>
                <button>Recharger</button> {/* Navigation vers Forfaits */}
            </div>
        </div>
    );
};
    </script>

    <script type="text/plain" id="code-moto-dash">
const MotoristaDashboard = () => {
    // √âtat Critique : D√©termine si le motard re√ßoit des demandes ou non
    const [isOnline, setIsOnline] = useState(false);
    // Liste des demandes de trajet entrantes en temps r√©el
    const [requests, setRequests] = useState([]);

    // Hook de G√©olocalisation Active
    // S'ex√©cute chaque fois que l'√©tat 'isOnline' change
    useEffect(() => {
        // API native du navigateur pour suivre la position
        const watcher = navigator.geolocation.watchPosition(pos => {
            // Nous mettons √† jour le serveur seulement si le conducteur travaille
            if(isOnline) {
                // Requ√™te PUT pour mettre √† jour lat/lng dans la table des motards
                // Cela rend le motard visible sur les cartes des clients proches
                axios.put('/api/moto/location', {
                    lat: pos.coords.latitude,
                    lng: pos.coords.longitude
                });
            }
        });
        // Nous nettoyons le watcher au d√©montage pour √©conomiser la batterie
        return () => navigator.geolocation.clearWatch(watcher);
    }, [isOnline]);

    // Fonction pour accepter un travail (gestion de race condition g√©r√©e en backend)
    const acceptTrip = async (id) => {
        // Tentative d'appropriation du trajet (Transaction Atomique en DB)
        await axios.post(`/api/viajes/${id}/accept`);
        // Si succ√®s : Changement de vue vers Mode Navigation (GPS)
    };

    return (
        <div>
            <header>
                {/* Switch Ma√Ætre : Contr√¥le la disponibilit√© globale du conducteur */}
                <Toggle checked={isOnline} onChange={setIsOnline} />
                <span>√âtat : {isOnline ? 'EN LIGNE' : 'HORS LIGNE'}</span>
            </header>

            {/* Rendu du Flux de Demandes (Push Notifications / WebSockets) */}
            {requests.map(req => (
                <TripRequestCard 
                    trip={req} 
                    onAccept={() => acceptTrip(req.id)} 
                />
            ))}
        </div>
    );
};
    </script>

    <script type="text/plain" id="code-moto-hist">
const MotoristaHistory = () => {
    // √âtat calcul√© : Total des revenus g√©n√©r√©s sur la p√©riode
    const [earnings, setEarnings] = useState(0);

    return (
        <div>
            {/* Widget de R√©sum√© Financier */}
            <div className="earnings-summary">
                <h3>Gains du Mois</h3>
                {/* Formatage en monnaie locale (CFA) */}
                <span>{earnings} CFA</span>
                {/* Bouton pour initier le processus de paiement vers compte mobile */}
                <button>Demander Retrait</button>
            </div>

            {/* Conteneur de liste (Virtual Scroll pour performance si beaucoup d'√©l√©ments) */}
            <div className="completed-trips">
               {/* Liste des trajets compl√©t√©s avec d√©tails du tarif et date */}
            </div>
        </div>
    );
};
    </script>

    <script type="text/plain" id="code-moto-prof">
const MotoristaProfile = () => {
    // √âtat pour garder l'info sp√©cifique du v√©hicule (Relation 1:1 en BD)
    const [motoInfo, setMotoInfo] = useState({});

    // Composant en lecture seule pour montrer la fiche technique
    // Ces donn√©es sont valid√©es par l'Admin avant d'activer le compte
    return (
        <div className="moto-details">
            <h2>Mon V√©hicule</h2>
            <div className="field">
                <label>Immatriculation</label>
                <span>{motoInfo.license_plate}</span>
            </div>
            <div className="field">
                <label>Mod√®le</label>
                <span>{motoInfo.model}</span>
            </div>
        </div>
    );
};
    </script>

    <script type="text/plain" id="code-admin-dash">
const AdminDashboard = () => {
    // √âtat global des m√©triques du syst√®me
    const [stats, setStats] = useState({});

    // Chargement des donn√©es au montage du tableau de bord
    useEffect(() => {
        // Endpoint agr√©g√© qui calcule les totaux :
        // COUNT(users), COUNT(trips), SUM(earnings), etc.
        axios.get('/api/admin/kpi').then(res => setStats(res.data));
    }, []);

    return (
        <div className="grid-dashboard">
            {/* Composants de Carte R√©utilisables pour KPIs */}
            <StatCard icon="üë•" label="Utilisateurs" val={stats.users} />
            <StatCard icon="üèçÔ∏è" label="Motards" val={stats.drivers} />
            <StatCard icon="üí∞" label="Revenus" val={stats.revenue} />
            
            {/* Conteneur Graphiques (Chart.js / Recharts) */}
            <div className="chart-container">
                {/* Visualisation de la tendance de croissance */}
                <GrowthChart data={stats.monthlyGrowth} />
            </div>
        </div>
    );
};
    </script>

    <script type="text/plain" id="code-admin-clients">
const AdminClientes = () => {
    // Liste de tous les utilisateurs inscrits avec le r√¥le 'client'
    const [users, setUsers] = useState([]);

    // Fonction administrative pour supprimer des utilisateurs (Soft Delete)
    const deleteUser = (id) => {
        // Confirmation native du navigateur avant action destructive
        if(confirm('Supprimer l\'utilisateur ?')) {
            // Appel DELETE √† l'API REST
            axios.delete(`/api/users/${id}`);
            // Mise √† jour optimiste de l'UI ou rechargement de la liste
        }
    };

    return (
        <table>
            {/* En-t√™te du tableau de gestion */}
            <thead>
                <tr><th>Nom</th><th>Email</th><th>R√¥le</th><th>Actions</th></tr>
            </thead>
            <tbody>
                {/* Rendu des lignes en it√©rant sur le tableau d'utilisateurs */}
                {users.map(u => (
                    <tr>
                        <td>{u.name}</td>
                        <td>{u.email}</td>
                        <td>{u.role}</td>
                        <td>
                            {/* Boutons d'action par ligne */}
                            <button onClick={()=>edit(u)}>√âditer</button>
                            <button onClick={()=>deleteUser(u.id)}>Supprimer</button>
                        </td>
                    </tr>
                ))}
            </tbody>
        </table>
    );
};
    </script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-jsx.min.js"></script>

    <script>
        let slideIndex = 1;
        const slides = document.getElementsByClassName("slide-block");
        const slideNumberText = document.querySelector(".slide-number");
        const codePanel = document.getElementById("codePanel");
        const codeBlock = document.getElementById("codeBlock");
        const mainContainer = document.getElementById("mainContainer");
        const fileNameLabel = document.getElementById("fileName");

        showSlides(slideIndex);

        function plusSlides(n) {
            showSlides(slideIndex += n);
        }

        function currentSlide(n) {
            showSlides(slideIndex = n);
        }

        function showSlides(n) {
            if (n > slides.length) { slideIndex = 1 }
            if (n < 1) { slideIndex = slides.length }

            // Hide all slides
            for (let i = 0; i < slides.length; i++) {
                slides[i].classList.remove("active");
            }

            // Show current
            const current = slides[slideIndex - 1];
            current.classList.add("active");
            slideNumberText.innerText = slideIndex + " / " + slides.length;

            // Update Code View if applicable
            const codeId = current.getAttribute('data-code');
            if (codeId) {
                const codeContent = document.getElementById(codeId).textContent;
                codeBlock.textContent = codeContent.trim();
                fileNameLabel.innerText = getFileNameForId(codeId);
                Prism.highlightElement(codeBlock);

                // Auto-show code panel if it was previously open or if we want to force it?
                // Let's keep user preference. But if user enables code, we update content.
                // If user toggles code ON, and current slide has NO code, we might want to hide it or show empty.
                if (codePanel.classList.contains('active')) {
                    // Keep it open
                }
            } else {
                codeBlock.textContent = "// Pas de code pertinent pour cette vue g√©n√©rale.";
                fileNameLabel.innerText = "Information";
                Prism.highlightElement(codeBlock);
            }
        }

        function toggleCode() {
            codePanel.classList.toggle("active");
            mainContainer.classList.toggle("has-code");
        }

        function getFileNameForId(id) {
            const map = {
                'code-landing': 'LandingPage.jsx',
                'code-register': 'RegisterPage.jsx',
                'code-client-dash': 'ClienteDashboard.jsx',
                'code-client-forfaits': 'ClienteForfaits.jsx',
                'code-client-hist': 'ClienteHistory.jsx',
                'code-client-prof': 'ClienteProfile.jsx',
                'code-moto-dash': 'MotoristaDashboard.jsx',
                'code-moto-hist': 'MotoristaHistory.jsx',
                'code-moto-prof': 'MotoristaProfile.jsx',
                'code-admin-dash': 'AdminDashboard.jsx',
                'code-admin-clients': 'AdminClientes.jsx',
            };
            return map[id] || 'Composant';
        }

        // Keyboard navigation
        document.addEventListener('keydown', function (event) {
            if (event.key === "ArrowRight" || event.key === " " || event.key === "Enter") {
                plusSlides(1);
            } else if (event.key === "ArrowLeft") {
                plusSlides(-1);
            } else if (event.key === "Escape") {
                closeModal();
            } else if (event.key === "c" || event.key === "C") {
                toggleCode();
            }
        });

        // Modal Logic
        function openModal(element) {
            var modal = document.getElementById("myModal");
            var modalImg = document.getElementById("img01");
            modal.style.display = "flex";
            modal.style.justifyContent = "center";
            modal.style.alignItems = "center";
            modalImg.src = element.src;
        }

        function closeModal() {
            var modal = document.getElementById("myModal");
            modal.style.display = "none";
        }

        document.getElementById("myModal").onclick = function (e) {
            if (e.target === this) closeModal();
        }

    </script>
</body>

</html>